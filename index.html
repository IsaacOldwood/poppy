<!DOCTYPE html>
<html>
	<head>
		<title>Poppy</title>
		<!-- link to main stylesheet -->
		<link rel="stylesheet" type="text/css" href="css/main.css">
		<!-- link to icon -->
		<link rel="shortcut icon" type="image/x-icon" href="favicon.ico">
		<link rel="icon" type="image/png" href="favicon-16x16.png" sizes="16x16">
		<link rel="icon" type="image/png" href="favicon-32x32.png" sizes="32x32">
		<link rel="apple-touch-icon" href="apple-touch-icon.png">
		<!--META TAGS-->
		<meta name = "keywords" content = "Dog, Website, Helpful" />
        <meta name = "description" content = "Keep track of if the dog has been fed and walked from anywhere." />
        <meta name = "revised" content = "IsaacOldwood, 01/05/2021" />
		<meta name = "author" content = "Isaac Oldwood" />
		<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
		<meta charset="UTF-8">
		<script>
			function sendData(data) {
				fetch('https://api.jsonbin.io/b/608d34138a409667ca022215', {
				  method: 'PUT',
				  headers: {
				    'Content-Type': 'application/json',
				  },
				  body: JSON.stringify(data),
				})
				.then(r => console.log(r));
			}
		</script>
		<script>
			function fed(time, data) {
				if (time == 'morn') {
					data['fed-morn'] = true;
					fed_morn_element.innerHTML = 'Yes';
				}
				else if (time == 'eve') {
					data['fed-eve'] = true;
					fed_eve_element.innerHTML = 'Yes';
				}

				sendData(data);
			}
		</script>
	</head>
	<body>
		<div class="centering-container">
			<h1>Poppy</h1>
		</div>
		<div class="centering-container">
			<h2>Has Poppy been fed?</h2>
		</div>
		<div class="centering-container">
			<h3><u>Morning</u></h3>
			<h4 id="fed-morn">Enable JS</h4>
			<button class="fed" onclick="fed('morn', data)">I have fed her this morning</button>
		</div>
		<div class="centering-container">
			<h3><u>Evening</u></h3>
			<h4 id="fed-eve">Enable JS</h4>
			<button class="fed" onclick="fed('eve', data)">I have fed her this evening</button>
		</div>
		<script>
			// Build up the page.
			var fed_morn_element = document.getElementById('fed-morn');
			var fed_eve_element = document.getElementById('fed-eve');
			fed_morn_element.innerHTML = 'Loading...';
			fed_eve_element.innerHTML = 'Loading...';
			var data;
			fetch('https://api.jsonbin.io/b/608d34138a409667ca022215/latest')
  			.then(response => response.json())
			.then(current_data => {
				var d = new Date();
				var day = d.getDay();
				data = current_data;
				if (data['day'] != day) {
					data = {
				    'day': day,
				    'fed-morn': false,
					'fed-eve': false
					};

					sendData(data);
				}
				else {
					console.log(data);
				}

				fed_morn_element.innerHTML = data['fed-morn'] ? 'Yes' : 'No';
				fed_eve_element.innerHTML = data['fed-eve'] ? 'Yes' : 'No';
			})
		</script>
	</body>
</html>
